"use strict";(self.webpackChunkstorybook=self.webpackChunkstorybook||[]).push([[9152],{"./stories/Components/Chart/timeline.stories.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{TimelineChartBasic:()=>TimelineChartBasic,__namedExportsOrder:()=>__namedExportsOrder,default:()=>__WEBPACK_DEFAULT_EXPORT__});var _ferlab_ui_core_components_Charts_ClinicalTrialTimeline__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../packages/ui/core/components/Charts/ClinicalTrialTimeline/index.js"),_ferlab_ui_core_components_Charts_ClinicalTrialTimeline__WEBPACK_IMPORTED_MODULE_1___default=/*#__PURE__*/__webpack_require__.n(_ferlab_ui_core_components_Charts_ClinicalTrialTimeline__WEBPACK_IMPORTED_MODULE_1__),react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),data=[{activities:["informed consent","safety monitoring","skin assessment","research blood draw"],event:"screening",visit_number:1,timepoint:-4,duration:4,threatment_active:!1},{activities:["pharmacy visit","safety monitoring","skin assessment","research blood draw","cognitive measures"],event:"baseline",visit_number:2,timepoint:0,duration:4,threatment_active:!0},{activities:["pharmacy visit","safety monitoring","research blood draw"],event:"2 week",visit_number:3,timepoint:2,duration:1,threatment_active:!0},{activities:["pharmacy visit","safety monitoring"],event:"4-week",visit_number:4,timepoint:4,duration:1,threatment_active:!0},{activities:["pharmacy visit","safety monitoring","skin assessment","research blood draw"],event:"8-week",visit_number:5,timepoint:8,duration:1.5,threatment_active:!0},{activities:["pharmacy visit","safety monitoring"],event:"12-week",visit_number:6,timepoint:12,duration:1,threatment_active:!0},{activities:["pharmacy visit","safety monitoring","skin assessment","research blood draw","cognitive measures"],event:"16-week",visit_number:7,timepoint:16,duration:4,threatment_active:!0},{activities:["safety monitoring","cognitive measures"],event:"Post Rx",visit_number:8,timepoint:18,duration:1,threatment_active:!1}];let __WEBPACK_DEFAULT_EXPORT__={title:"@ferlab/Components/Charts/Timeline",component:_ferlab_ui_core_components_Charts_ClinicalTrialTimeline__WEBPACK_IMPORTED_MODULE_1___default(),decorators:[function(Story){return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(react__WEBPACK_IMPORTED_MODULE_0__.Fragment,null,/*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("h2",null,Story),/*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(Story,null))}]};var TimelineChartBasic=function(){return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(react__WEBPACK_IMPORTED_MODULE_0__.Fragment,null,/*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("h2",null,"Timeline Chart"),/*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div",null,/*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_ferlab_ui_core_components_Charts_ClinicalTrialTimeline__WEBPACK_IMPORTED_MODULE_1___default(),{title:"Tofacitinib",data:data,loading:!1,height:350,width:600})))};TimelineChartBasic.parameters={...TimelineChartBasic.parameters,docs:{...TimelineChartBasic.parameters?.docs,source:{originalSource:'() => <>\n        <h2>Timeline Chart</h2>\n        <div>\n            <ClinicalTrialTimelineChart title="Tofacitinib" data={data} loading={false} height={350} width={600} />\n        </div>\n    </>',...TimelineChartBasic.parameters?.docs?.source}}};let __namedExportsOrder=["TimelineChartBasic"]},"../packages/ui/core/components/Charts/ClinicalTrialTimeline/index.js":function(__unused_webpack_module,exports,__webpack_require__){function _array_like_to_array(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _array_without_holes(arr){if(Array.isArray(arr))return _array_like_to_array(arr)}function _iterable_to_array(iter){if("undefined"!=typeof Symbol&&null!=iter[Symbol.iterator]||null!=iter["@@iterator"])return Array.from(iter)}function _non_iterable_spread(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _to_consumable_array(arr){return _array_without_holes(arr)||_iterable_to_array(arr)||_unsupported_iterable_to_array(arr)||_non_iterable_spread()}function _unsupported_iterable_to_array(o,minLen){if(o){if("string"==typeof o)return _array_like_to_array(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if("Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _array_like_to_array(o,minLen)}}var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){void 0===k2&&(k2=k);var desc=Object.getOwnPropertyDescriptor(m,k);(!desc||("get"in desc?!m.__esModule:desc.writable||desc.configurable))&&(desc={enumerable:!0,get:function get(){return m[k]}}),Object.defineProperty(o,k2,desc)}:function(o,m,k,k2){void 0===k2&&(k2=k),o[k2]=m[k]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:!0,value:v})}:function(o,v){o.default=v}),__importStar=this&&this.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(null!=mod)for(var k in mod)"default"!==k&&Object.prototype.hasOwnProperty.call(mod,k)&&__createBinding(result,mod,k);return __setModuleDefault(result,mod),result};Object.defineProperty(exports,"__esModule",{value:!0});var react_1=__importStar(__webpack_require__("./node_modules/react/index.js")),d3=__importStar(__webpack_require__("../packages/ui/node_modules/d3/src/index.js")),uuid_1=__webpack_require__("../packages/ui/node_modules/uuid/dist/esm-browser/index.js"),DEFAULT_TIMELINE_DICTIONARY={timeWeek:"Time (weeks)",visitLength:"Visit length (hrs)",visitNumber:"Visit #"};exports.default=function(param){var data=param.data,_param_dictionary=param.dictionary,dictionary=void 0===_param_dictionary?DEFAULT_TIMELINE_DICTIONARY:_param_dictionary,height=param.height,loading=param.loading,_param_margin=param.margin,margin=void 0===_param_margin?{bottom:40,left:140,right:30,top:120}:_param_margin,title=param.title,width=param.width,ref=(0,react_1.useRef)(null),chartId="timeline-chart-".concat((0,uuid_1.v4)()),activities=(0,react_1.useMemo)(function(){return _to_consumable_array(new Set(data.flatMap(function(d){return d.activities.map(function(activity){return activity})})))},[data]);return(0,react_1.useEffect)(function(){if(!loading&&(null==ref?void 0:ref.current)){var svg=d3.select("#".concat(chartId)).append("svg").attr("viewBox","0 0 ".concat(width+margin.left+margin.right," ").concat(height+margin.top+margin.bottom)).append("g").attr("transform","translate("+margin.left+","+margin.top+")"),xScale=d3.scaleBand().domain(data.map(function(d){return d.event})).range([0,width]).paddingInner(.2).paddingOuter(.2),xAxis=d3.axisTop(xScale).tickSizeOuter(0);svg.append("g").call(xAxis).selectAll("text").style("font-size","12px").style("font-weight","bold");var yScale=d3.scaleBand().domain(activities.map(function(activity){return activity})).range([0,height]),yAxis=d3.axisLeft(yScale).tickPadding(10).tickSizeOuter(0);svg.append("g").call(yAxis).selectAll("text").style("font-size","12px").style("font-weight","bold").style("text-transform","capitalize");var colorScale=d3.scaleOrdinal().domain(activities).range(d3.schemeCategory10);svg.selectAll("rect.activity-square").data(data.flatMap(function(d){return d.activities.map(function(activity){return{activity:activity,event:d.event}})})).enter().append("rect").attr("class","activity-square").attr("x",function(d){return xScale(d.event)||0}).attr("y",function(d){return yScale(d.activity)||0}).attr("width",xScale.bandwidth()).attr("height",yScale.bandwidth()).style("fill",function(d){return colorScale(d.activity)}),svg.selectAll("line.horizontal-grid").data(activities).enter().append("line").attr("class","horizontal-grid").attr("x1",0).attr("y1",function(d){return(yScale(d)||0)+yScale.bandwidth()}).attr("x2",width).attr("y2",function(d){return(yScale(d)||0)+yScale.bandwidth()}).style("stroke","black").style("stroke-width",1);var xThreamentScale=d3.scaleBand().domain(data.map(function(d){return d.event})).range([0,width]).paddingOuter(1);svg.selectAll("rect.threatment-square").data(data).enter().append("rect").attr("class","activity-square").attr("x",function(d){return xThreamentScale(d.event)||0}).attr("y",-100).attr("width",xThreamentScale.bandwidth()).attr("height",10).style("fill",function(d){return d.threatment_active?"red":"transparent"}),svg.append("text").attr("class","visit-number-label").attr("x",-62).attr("y",-90).attr("text-anchor","left").style("font-size","12px").style("fill","gray").text("".concat(title,":"));var defs=svg.append("defs");defs.append("marker").attr("id","arrowhead-right").attr("refX",10).attr("viewBox","0 0 ".concat(16," ").concat(16)).attr("refY",5).attr("markerWidth",16).attr("markerHeight",16).attr("orient","auto").append("path").attr("d","M 0 0 L 10 5 L 0 10 Z").style("fill","black"),defs.append("marker").attr("id","arrowhead-left").attr("viewBox","0 0 ".concat(16," ").concat(16)).attr("refX",0).attr("refY",5).attr("markerWidth",16).attr("markerHeight",16).attr("orient","auto").append("path").attr("d","M 10 0 L 0 5 L 10 10 Z").style("fill","black"),svg.selectAll("line.timepoint-horizontal-line").data(data).enter().append("line").attr("class","timepoint-horizontal-line").attr("x1",0).attr("x2",width).attr("y1",-50).attr("y2",-50).style("stroke","black").style("stroke-width",1).attr("marker-start","url(#arrowhead-left)").attr("marker-end","url(#arrowhead-right)"),svg.selectAll("line.timepoint-vertical-lines").data(data).enter().append("line").attr("class","timepoint-vertical-lines").attr("x1",function(d){return(xScale(d.event)||0)+xScale.bandwidth()/2}).attr("x2",function(d){return(xScale(d.event)||0)+xScale.bandwidth()/2}).attr("y1",-55).attr("y2",-45).style("stroke","black").style("stroke-width",1),svg.append("foreignObject").attr("x",-margin.left).attr("y",-72).attr("width",margin.left-16).attr("height",20).append("xhtml:div").style("font-size","12px").style("color","gray").style("text-align","right").text(dictionary.visitNumber),svg.append("foreignObject").attr("x",-margin.left).attr("y",-44).attr("width",margin.left-16).attr("height",20).append("xhtml:div").style("font-size","12px").style("color","gray").style("text-align","right").text(dictionary.timeWeek),svg.selectAll("text.visit-number-text").data(data).enter().append("text").attr("class","visit-number-text").attr("x",function(d){return(xScale(d.event)||0)+xScale.bandwidth()/2}).attr("y",-58).attr("text-anchor","middle").style("font-size","12px").style("fill","black").text(function(d){return"".concat(d.visit_number)}),svg.selectAll("text.timepoint-text").data(data).enter().append("text").attr("class","timepoint-text").attr("x",function(d){return(xScale(d.event)||0)+xScale.bandwidth()/2}).attr("y",-32).attr("text-anchor","middle").style("font-size","12px").style("fill","black").text(function(d){return"".concat(d.timepoint)}),svg.append("foreignObject").attr("x",-margin.left-18).attr("y",height+10).attr("width",margin.left).attr("height",20).append("xhtml:div").style("font-size","12px").style("color","black").style("text-align","right").text(dictionary.visitLength),svg.selectAll("text.visit-length-text").data(data).enter().append("text").attr("class","visit-length-text").attr("x",function(d){return(xScale(d.event)||0)+xScale.bandwidth()/2}).attr("y",height+25).attr("text-anchor","middle").style("font-size","12px").style("fill","black").text(function(d){return"".concat(d.duration.toFixed(2))})}},[loading,ref,activities,dictionary]),react_1.default.createElement("div",{id:chartId,ref:ref,style:{maxHeight:height,maxWidth:width}})}}}]);